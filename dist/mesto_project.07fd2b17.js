let e;const u=document.querySelectorAll(".popup"),t="popup_opened",n="popup_closed",r=document.querySelectorAll(".popup__container_fields"),o=document.querySelector("#edit-button"),c=document.querySelector("#profile-popup-close-button"),l=document.querySelector("#edit-profile-popup"),s=document.querySelector("#save-profile-button"),a=document.forms.editProfileForm,i=document.querySelector("#add-picture-button"),d=document.querySelector("#pictures-popup-close-button"),m=document.querySelector("#add-pictures-popup"),p=document.querySelector("#save-pictures-button"),_=document.querySelector("#full-screen-picture-close-button"),E=[],f=document.querySelector(".elements"),y=document.querySelector("#place").content;let v=document.querySelector("#edit-place-name"),h=document.querySelector("#edit-place-link");const S=document.querySelector(".profile__info_avatar"),k=document.querySelector("#change-avatar"),q=document.querySelector("#avatar-popup-close-button"),b=document.querySelector("#save-avatar-button"),A=document.querySelector("#input-avatar-link");let D=document.querySelector("#edit-user-name"),L=document.querySelector("#edit-user-about"),C=document.querySelector("#profile-user-name"),g=document.querySelector("#profile-user-about"),$=document.querySelector("#profile-user-avatar");const x=document.querySelector("#full-screen-picture-popup"),B=document.querySelector(".full-screen-picture-header"),j=document.querySelector("#confirm-delete-picture-popup"),T=document.querySelector("#confirm-delete-picture-button"),F=document.querySelector("#confirm-delete-pictures-popup-close-button");function P(e,u){e.some(e=>!e.validity.valid)?u.disabled=!0:null===u?u=!1:u.disabled=!1}function w(e){e.addEventListener("submit",e=>{e.preventDefault(),a.reset()}),e.addEventListener("submit",e=>{e.preventDefault(),addPlaceForm.reset()})}function O(e){e.classList.add(t),e.classList.remove(n)}function I(e){e.classList.remove(t),e.classList.add(n),N(),v.value="",h.value="",document.querySelectorAll(".popup__container_field-error_visible").forEach(e=>{e.classList.remove("popup__container_field-error_visible")})}function N(){D.value=C.textContent.trim(),L.value=g.textContent.trim()}function J(){C.textContent=D.value.trim(),g.textContent=L.value.trim(),N()}function G(e){e.textContent="Сохранение..."}function H(e){e.textContent="Сохранить"}const z="./backend.js",M={authorization:"14b58559-029e-496e-9a10-e787d4f1cf4c","Content-Type":"application/json"};async function U(){return fetch(z+"/users/me",{method:"GET",headers:M}).then(e=>e.ok?e.json():Promise.reject(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{437}\u{430}\u{433}\u{440}\u{443}\u{437}\u{438}\u{442}\u{44C} \u{434}\u{430}\u{43D}\u{43D}\u{44B}\u{435} \u{43F}\u{440}\u{43E}\u{444}\u{438}\u{43B}\u{44F}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`))}async function K(){return fetch(z+"/cards",{method:"GET",headers:M}).then(e=>e.ok?e.json():Promise.reject(console.error(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{437}\u{430}\u{433}\u{440}\u{443}\u{437}\u{438}\u{442}\u{44C} \u{43A}\u{430}\u{440}\u{442}\u{43E}\u{447}\u{43A}\u{438}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`)))}async function Q(e,u){return fetch(z+"/users/me",{method:"PATCH",headers:M,body:JSON.stringify({name:e,about:u})}).then(e=>e.ok?e.json():Promise.reject(console.error(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{43E}\u{431}\u{43D}\u{43E}\u{432}\u{438}\u{442}\u{44C} \u{434}\u{430}\u{43D}\u{43D}\u{44B}\u{435} \u{43F}\u{440}\u{43E}\u{444}\u{438}\u{43B}\u{44F}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`)))}async function R(e,u){return fetch(z+"/cards",{method:"POST",headers:M,body:JSON.stringify({name:e,link:u})}).then(e=>e.ok?e.json():Promise.reject(console.error(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{437}\u{430}\u{433}\u{440}\u{443}\u{437}\u{438}\u{442}\u{44C} \u{43A}\u{430}\u{440}\u{442}\u{43E}\u{447}\u{43A}\u{443}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`)))}async function V(e,u,t){return fetch(z+`/cards/${t}`,{method:"DELETE",headers:M,body:JSON.stringify({name:e,link:u})}).then(e=>e.ok?e.json():Promise.reject(console.error(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{443}\u{434}\u{430}\u{43B}\u{438}\u{442}\u{44C} \u{43A}\u{430}\u{440}\u{442}\u{43E}\u{447}\u{43A}\u{443}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`)))}async function W(e){return fetch(z+`/cards/likes/${e}`,{method:"PUT",headers:M}).then(e=>e.ok?e.json():Promise.reject(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{43F}\u{43E}\u{441}\u{442}\u{430}\u{432}\u{438}\u{442}\u{44C} \u{43B}\u{430}\u{439}\u{43A}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`))}async function X(e){return fetch(z+`/cards/likes/${e}`,{method:"DELETE",headers:M}).then(e=>e.ok?e.json():Promise.reject(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{443}\u{431}\u{440}\u{430}\u{442}\u{44C} \u{43B}\u{430}\u{439}\u{43A}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`))}async function Y(e){return fetch(z+"/users/me/avatar",{method:"PATCH",headers:M,body:JSON.stringify({avatar:e})}).then(e=>e.ok?e.json():Promise.reject(console.error(`\u{41D}\u{435} \u{443}\u{434}\u{430}\u{43B}\u{43E}\u{441}\u{44C} \u{43E}\u{431}\u{43D}\u{43E}\u{432}\u{438}\u{442} \u{430}\u{432}\u{430}\u{442}\u{430}\u{440}. \u{41E}\u{448}\u{438}\u{431}\u{43A}\u{430}: ${e.status}. ${e.statusText}`)))}function Z(){document.querySelectorAll(".elements__element_pic_remove-button").forEach(e=>{e.addEventListener("click",e=>{O(j),T.addEventListener("click",u=>{u.preventDefault(),async function(){try{await function(e){let u=e.target.closest(".elements__element");u.remove(),function(e,u){let t,n=e.closest(".elements__element").querySelector(".elements__element_pic");u.findIndex((e,u)=>{let r=e.id===n.getAttribute("dataId");r&&r&&(t=u,async function(){try{await V(e.name,e.link,e.id)}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}())}),u.splice(t,1)}(u,E)}(e)}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}(),I(j)})})})}F.addEventListener("click",e=>{e.preventDefault(),I(j)}),(async()=>{try{var u;C.textContent=(u=e=await U()).name,g.textContent=u.about,$.setAttribute("src",u.avatar),N()}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}})();try{(async()=>{(await K()).forEach(e=>{ee(e)})})()}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}function ee(u){var t,n,r,o;let c,l=u.owner._id===e._id,s=u.likes.some(u=>u._id===e._id);t=u.name,n=u.link,r=u._id,o=u.likes,(c={}).name=t,c.link=n,c.userIsOwner=l,c.id=r,c.likes=o.length,E.push(c),function(e,u){let t=E[E.length-1],n=y.querySelector(".elements__element").cloneNode(!0);n.querySelector(".elements__element_pic").src=t.link,n.querySelector(".elements__element_header").textContent=t.name,n.querySelector(".elements__element_like-counter").textContent=t.likes,n.querySelector(".elements__element_pic").setAttribute("alt",t.name),u&&n.querySelector(".elements__element_like-img").classList.add("elements__element_like-img_active"),n.querySelector(".elements__element_pic").setAttribute("dataId",e),f.prepend(n);let r=document.querySelector(".elements__element_pic_remove-button");t.userIsOwner||r.classList.add("disable_btn")}(u._id,s),Z(),document.querySelectorAll(".elements__element_pic").forEach(e=>{e.addEventListener("click",function(e){x.querySelector(".full-screen-picture").src=e.target.src,B.textContent=e.target.closest(".elements__element").querySelector(".elements__element_header").textContent,O(x)})});let a=document.querySelector(".elements__element_like-img");a.addEventListener("click",function(e){let u=a.closest(".elements__element").querySelector(".elements__element_pic").getAttribute("dataId"),t=e.target;t.classList.contains("elements__element_like-img_active")?async function(){try{let e=await X(u);t.closest(".elements__element").querySelector(".elements__element_like-counter").textContent=e.likes.length}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}():async function(){try{let e=await W(u);t.closest(".elements__element").querySelector(".elements__element_like-counter").textContent=e.likes.length}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}(),e.target.classList.toggle("elements__element_like-img_active")})}async function eu(e){try{e.preventDefault(),G(s),J(),await Q(C.textContent,g.textContent),H(s),I(l)}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}async function et(e){try{e.preventDefault(),G(p);let u=await R(v.value,h.value);ee(u),H(p),I(m)}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}async function en(){try{let e=A.value;await Y(e),$.src=A.value,I(k)}catch(e){console.error(`\u{427}\u{442}\u{43E}-\u{442}\u{43E} \u{43F}\u{43E}\u{448}\u{43B}\u{43E} \u{43D}\u{435} \u{442}\u{430}\u{43A}: ${e}`)}}o.addEventListener("click",()=>O(l)),s.addEventListener("click",e=>eu(e)),c.addEventListener("click",e=>{e.preventDefault(),I(l),N()}),K(),i.addEventListener("click",()=>{O(m)}),d.addEventListener("click",e=>{e.preventDefault(),I(m)}),Z(),p.addEventListener("click",e=>{et(e)}),_.addEventListener("click",function(e){e.preventDefault(),I(x)}),S.addEventListener("click",e=>{e.preventDefault(),O(k)}),q.addEventListener("click",e=>{e.preventDefault(),I(k)}),b.addEventListener("click",e=>{e.preventDefault(),en()}),u.forEach(e=>{e.addEventListener("mousedown",function(e){e.target.classList.contains("popup")&&0===e.button&&I(this.closest(".popup"))})}),document.addEventListener("keyup",function(e){u.forEach(u=>{u.classList.contains("popup_closed")||"Escape"!==e.key||I(u)})}),r.forEach(e=>{e.addEventListener("keyup",function(e){"Enter"===e.code&&e.target.matches(e.target.button)&&(J(),I(this.closest(".popup"))),"Enter"===e.code&&e.target.matches(".place-input")&&e.target.button&&(saveAddedPicture(),I(this.closest(".popup")))})}),Array.from(document.querySelectorAll(".popup__container")).forEach(e=>{let u=Array.from(e.querySelectorAll(".popup__container_fields")),t=e.querySelector(".popup__container_save-button");P(u,t),u.forEach(e=>{e.addEventListener("input",e=>{var n=e.target;let r=n.nextElementSibling;n.validity.valid?r.classList.remove("popup__container_field-error_visible"):(r.textContent=n.validationMessage,r.classList.add("popup__container_field-error_visible")),P(u,t)})})}),w(o),w(i);
//# sourceMappingURL=mesto_project.07fd2b17.js.map
